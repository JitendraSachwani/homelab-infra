- name: Wait for MySQL to be reachable
  ansible.builtin.wait_for:
    host: "{{ ansible_host }}"
    port: 3306
    timeout: 30

- name: Verify MySQL responds
  ansible.builtin.command: mysql -h {{ ansible_host }} -e "SELECT 1;"
  register: mysql_test
  failed_when: mysql_test.rc != 0
  changed_when: false
